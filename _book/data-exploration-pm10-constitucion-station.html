<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>9 Data Exploration PM10 Constitucion Station | Gijón Air Pollution</title>
  <meta name="description" content="9 Data Exploration PM10 Constitucion Station | Gijón Air Pollution">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="9 Data Exploration PM10 Constitucion Station | Gijón Air Pollution" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Data Exploration PM10 Constitucion Station | Gijón Air Pollution" />
  
  
  

<meta name="author" content="Sergio Berdiales">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-exploration.html">
<link rel="next" href="prediction-models-arima.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#why"><i class="fa fa-check"></i><b>2.1</b> Why</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#what"><i class="fa fa-check"></i><b>2.2</b> What</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#how"><i class="fa fa-check"></i><b>2.3</b> How</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>3</b> The Data</a></li>
<li class="chapter" data-level="4" data-path="visualizations.html"><a href="visualizations.html"><i class="fa fa-check"></i><b>4</b> Visualizations</a></li>
<li class="chapter" data-level="5" data-path="prediction-models.html"><a href="prediction-models.html"><i class="fa fa-check"></i><b>5</b> Prediction Models</a><ul>
<li class="chapter" data-level="5.1" data-path="prediction-models.html"><a href="prediction-models.html#arima"><i class="fa fa-check"></i><b>5.1</b> ARIMA</a></li>
<li class="chapter" data-level="5.2" data-path="prediction-models.html"><a href="prediction-models.html#machine-learning-methods"><i class="fa fa-check"></i><b>5.2</b> Machine Learning Methods</a></li>
<li class="chapter" data-level="5.3" data-path="prediction-models.html"><a href="prediction-models.html#neural-networks"><i class="fa fa-check"></i><b>5.3</b> Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>6</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html"><i class="fa fa-check"></i><b>7</b> Gathering and Cleaning Data</a><ul>
<li class="chapter" data-level="7.1" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#data-gathering"><i class="fa fa-check"></i><b>7.1</b> Data gathering</a></li>
<li class="chapter" data-level="7.2" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#data-cleaning"><i class="fa fa-check"></i><b>7.2</b> Data cleaning</a></li>
<li class="chapter" data-level="7.3" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#adding-new-variables"><i class="fa fa-check"></i><b>7.3</b> Adding new variables</a><ul>
<li class="chapter" data-level="7.3.1" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#time-variables"><i class="fa fa-check"></i><b>7.3.1</b> Time variables</a></li>
<li class="chapter" data-level="7.3.2" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#laboral-dates"><i class="fa fa-check"></i><b>7.3.2</b> Laboral dates</a></li>
<li class="chapter" data-level="7.3.3" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#wind-direction"><i class="fa fa-check"></i><b>7.3.3</b> Wind direction</a></li>
<li class="chapter" data-level="7.3.4" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#tables-preparation-for-tableau-dashboards"><i class="fa fa-check"></i><b>7.3.4</b> Tables preparation for Tableau Dashboards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>8</b> Data Exploration</a><ul>
<li class="chapter" data-level="8.0.1" data-path="data-exploration.html"><a href="data-exploration.html#relationships-between-variables"><i class="fa fa-check"></i><b>8.0.1</b> Relationships between variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-exploration-pm10-constitucion-station.html"><a href="data-exploration-pm10-constitucion-station.html"><i class="fa fa-check"></i><b>9</b> Data Exploration PM10 Constitucion Station</a></li>
<li class="chapter" data-level="10" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html"><i class="fa fa-check"></i><b>10</b> Prediction Models. ARIMA</a><ul>
<li class="chapter" data-level="10.0.1" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#prediction-is-very-difficult-especially-if-its-about-the-future."><i class="fa fa-check"></i><b>10.0.1</b> “Prediction is very difficult, especially if it’s about the future.”</a></li>
<li class="chapter" data-level="10.0.2" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#i-have-seen-the-future-and-it-is-very-much-like-the-present-only-longer."><i class="fa fa-check"></i><b>10.0.2</b> “I have seen the future and it is very much like the present, only longer.”</a></li>
<li class="chapter" data-level="10.1" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#pm10-hourly-prediction-models"><i class="fa fa-check"></i><b>10.1</b> PM10 hourly prediction models</a><ul>
<li class="chapter" data-level="10.1.1" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#data-loading"><i class="fa fa-check"></i><b>10.1.1</b> Data loading</a></li>
<li class="chapter" data-level="10.1.2" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#train-test-and-validation-data"><i class="fa fa-check"></i><b>10.1.2</b> Train, test and validation data</a></li>
<li class="chapter" data-level="10.1.3" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#data-exploration-1"><i class="fa fa-check"></i><b>10.1.3</b> Data Exploration</a></li>
<li class="chapter" data-level="10.1.4" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#arima-model"><i class="fa fa-check"></i><b>10.1.4</b> ARIMA model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#we-have-been-using-a-dataset-for-training-of-3-years.-is-this-necessary-does-the-arima-algorithm-take-advantage-of-a-so-long-time-series"><i class="fa fa-check"></i><b>10.2</b> We have been using a dataset for training of 3 years. Is this necessary? Does the Arima algorithm take advantage of a so long time series?</a><ul>
<li class="chapter" data-level="10.2.1" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#no2-predictions"><i class="fa fa-check"></i><b>10.2.1</b> NO2 Predictions</a></li>
<li class="chapter" data-level="10.2.2" data-path="prediction-models-arima.html"><a href="prediction-models-arima.html#arima-model-1"><i class="fa fa-check"></i><b>10.2.2</b> ARIMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Gijón Air Pollution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-exploration-pm10-constitucion-station" class="section level1">
<h1><span class="header-section-number">9</span> Data Exploration PM10 Constitucion Station</h1>
<p>We create the dataset pm10 with PM10 values from the Constitución Station and we execute a summary</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pm10 &lt;-<span class="st"> </span>air_data_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Constituci?n&#39;</span>) <span class="op">%&gt;%</span>
<span class="st">                        </span><span class="kw">select</span>(date_time_utc, PM10)

<span class="kw">summary</span>(pm10)</code></pre></div>
<pre><code>##  date_time_utc      PM10    
##  Min.   :NA    Min.   : NA  
##  1st Qu.:NA    1st Qu.: NA  
##  Median :NA    Median : NA  
##  Mean   :NA    Mean   :NaN  
##  3rd Qu.:NA    3rd Qu.: NA  
##  Max.   :NA    Max.   : NA</code></pre>
<p>25% of the values are between 44.00 and 888.00. 888.00 is a value really extreme. How many extreme values (outliers) do we have in this series? We plot all the values to visualise this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(pm10, <span class="kw">aes</span>(<span class="dt">x =</span> date_time_utc, <span class="dt">y =</span> PM10)) <span class="op">+</span><span class="st"> </span>
<span class="st">         </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="\textwidth" /> We have very few values greater than 250. So, it doesn’t seem we have a problem with the outliers (Pending: A PM10 level of 880 is something possible or is it likely to be a monitoring error?).</p>
<p>Daily averages</p>
<p>We create a new dataset with the PM10 daily averages and we plot them in a new graphic. We add a trend line too. There is a clear downward trend in the measurements and we have many fewer extreme values during the last decade. It seems like we have two very clear “epochs” in the data, before and after the year 2008.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pm10_day_avg &lt;-<span class="st"> </span>pm10 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="dt">day =</span> <span class="kw">date</span>(date_time_utc)) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">summarise</span>(<span class="dt">day_avg =</span> <span class="kw">mean</span>(PM10, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

<span class="kw">ggplot</span>(pm10_day_avg, <span class="kw">aes</span>(<span class="dt">x =</span> day, <span class="dt">y =</span> day_avg, , <span class="dt">colour =</span> day_avg)) <span class="op">+</span><span class="st"> </span>
<span class="st">         </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">         </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">         </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colours =</span> <span class="kw">terrain.colors</span>(<span class="dv">10</span>)) <span class="op">+</span>
<span class="st">         </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.9</span>),
                <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>), <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="op">+</span>
<span class="st">         </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;PM10 daily average (colour scale)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;PM10 daily average&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;PM10 daily average - 2000-2017 evolution (Constitución Station)&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="\textwidth" /></p>
<p>We identify a very clear trend through the years on the last graph. But, as we already saw before on the grid graphs there are other things happening at the same time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_const &lt;-<span class="st"> </span>year_avgs_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &quot;Constitución&quot;, contaminante == &#39;PM10&#39;)</span>
<span class="st">plot1 &lt;- ggplot(year_const, aes(x = year, y = value)) + </span>
<span class="st">  geom_line()</span>

<span class="st">month_const &lt;- month_avgs_long %&gt;% filter(station_alias == &quot;</span>Constitución&quot;, contaminante <span class="op">==</span><span class="st"> &#39;PM10&#39;</span>)
plot2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(month_const, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>()

week_day_const &lt;-<span class="st"> </span>week_day_avgs_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &quot;Constitución&quot;, contaminante == &#39;PM10&#39;)</span>
<span class="st">plot3 &lt;- ggplot(week_day_const, aes(x = week_day, y = value)) + </span>
<span class="st">  geom_line()</span>

<span class="st">hour_const &lt;- hour_avgs_long %&gt;% filter(station_alias == &quot;</span>Constitución&quot;, contaminante <span class="op">==</span><span class="st"> &#39;PM10&#39;</span>)
plot4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(hour_const, <span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>()

<span class="kw">grid.arrange</span>(plot1, plot2, plot3, plot4, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="\textwidth" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-exploration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prediction-models-arima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
