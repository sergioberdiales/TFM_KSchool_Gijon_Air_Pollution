<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6 Gathering and Cleaning Data | Gijón Air Pollution - An exercise of visualization and forecasting</title>
  <meta name="description" content="6 Gathering and Cleaning Data | Gijón Air Pollution - An exercise of visualization and forecasting">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6 Gathering and Cleaning Data | Gijón Air Pollution - An exercise of visualization and forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Gathering and Cleaning Data | Gijón Air Pollution - An exercise of visualization and forecasting" />
  
  
  

<meta name="author" content="Sergio Berdiales">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r-scripts.html">
<link rel="next" href="data-exploration.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#why"><i class="fa fa-check"></i><b>1.1</b> Why</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what"><i class="fa fa-check"></i><b>1.2</b> What</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#how"><i class="fa fa-check"></i><b>1.3</b> How</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2</b> The Data</a></li>
<li class="chapter" data-level="3" data-path="visualizations.html"><a href="visualizations.html"><i class="fa fa-check"></i><b>3</b> Visualizations</a></li>
<li class="chapter" data-level="4" data-path="forecasting-models.html"><a href="forecasting-models.html"><i class="fa fa-check"></i><b>4</b> Forecasting Models</a><ul>
<li class="chapter" data-level="4.1" data-path="forecasting-models.html"><a href="forecasting-models.html#pm10-forecasts"><i class="fa fa-check"></i><b>4.1</b> PM10 forecasts</a><ul>
<li class="chapter" data-level="" data-path="forecasting-models.html"><a href="forecasting-models.html#arima-results"><i class="fa fa-check"></i>ARIMA results</a></li>
<li class="chapter" data-level="" data-path="forecasting-models.html"><a href="forecasting-models.html#machine-learning-results"><i class="fa fa-check"></i>Machine Learning results</a></li>
<li class="chapter" data-level="" data-path="forecasting-models.html"><a href="forecasting-models.html#neural-networks"><i class="fa fa-check"></i>Neural Networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>5</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li><a href="r-scripts.html#r-scripts"><em>R scripts</em></a></li>
<li class="chapter" data-level="6" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html"><i class="fa fa-check"></i><b>6</b> Gathering and Cleaning Data</a><ul>
<li class="chapter" data-level="6.1" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#data-gathering"><i class="fa fa-check"></i><b>6.1</b> Data gathering</a></li>
<li class="chapter" data-level="6.2" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#data-cleaning"><i class="fa fa-check"></i><b>6.2</b> Data cleaning</a></li>
<li class="chapter" data-level="6.3" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#adding-new-variables"><i class="fa fa-check"></i><b>6.3</b> Adding new variables</a><ul>
<li class="chapter" data-level="6.3.1" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#time-variables"><i class="fa fa-check"></i><b>6.3.1</b> Time variables</a></li>
<li class="chapter" data-level="6.3.2" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#laboral-dates"><i class="fa fa-check"></i><b>6.3.2</b> Laboral dates</a></li>
<li class="chapter" data-level="6.3.3" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#wind-direction"><i class="fa fa-check"></i><b>6.3.3</b> Wind direction</a></li>
<li class="chapter" data-level="6.3.4" data-path="gathering-and-cleaning-data.html"><a href="gathering-and-cleaning-data.html#tables-preparation-for-tableau-dashboards"><i class="fa fa-check"></i><b>6.3.4</b> Tables preparation for Tableau dashboards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>7</b> Data Exploration</a><ul>
<li class="chapter" data-level="7.1" data-path="data-exploration.html"><a href="data-exploration.html#pm10-constitucion-station"><i class="fa fa-check"></i><b>7.1</b> PM10 Constitucion Station</a></li>
<li class="chapter" data-level="7.2" data-path="data-exploration.html"><a href="data-exploration.html#relationships-between-variables"><i class="fa fa-check"></i><b>7.2</b> Relationships between variables</a></li>
<li class="chapter" data-level="7.3" data-path="data-exploration.html"><a href="data-exploration.html#no2-constitucion-station"><i class="fa fa-check"></i><b>7.3</b> NO2 Constitucion Station</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html"><i class="fa fa-check"></i><b>8</b> Forecasting models. ARIMA</a><ul>
<li class="chapter" data-level="8.0.1" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#data-loading"><i class="fa fa-check"></i><b>8.0.1</b> Data loading</a></li>
<li class="chapter" data-level="8.0.2" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10-forecasting-models"><i class="fa fa-check"></i><b>8.0.2</b> PM10 forecasting models</a></li>
<li class="chapter" data-level="8.0.3" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#train-test-and-validation-data-pm10-models"><i class="fa fa-check"></i><b>8.0.3</b> Train, test and validation data (PM10 models)</a></li>
<li class="chapter" data-level="8.0.4" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#data-exploration-1"><i class="fa fa-check"></i><b>8.0.4</b> Data Exploration</a></li>
<li class="chapter" data-level="8.1" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#base-model."><i class="fa fa-check"></i><b>8.1</b> Base model.</a></li>
<li class="chapter" data-level="8.2" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10-arima-models"><i class="fa fa-check"></i><b>8.2</b> PM10 ARIMA models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10_model_arima_3m"><i class="fa fa-check"></i><b>8.2.1</b> PM10_model_arima_3m</a></li>
<li class="chapter" data-level="8.2.2" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10_model_arima_3y"><i class="fa fa-check"></i><b>8.2.2</b> PM10_model_arima_3y</a></li>
<li class="chapter" data-level="8.2.3" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10_model_arima_9y"><i class="fa fa-check"></i><b>8.2.3</b> PM10_model_arima_9y</a></li>
<li class="chapter" data-level="8.2.4" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10-h-6"><i class="fa fa-check"></i><b>8.2.4</b> PM10 h = 6</a></li>
<li class="chapter" data-level="8.2.5" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10-h-12"><i class="fa fa-check"></i><b>8.2.5</b> PM10 h = 12</a></li>
<li class="chapter" data-level="8.2.6" data-path="forecasting-models-arima.html"><a href="forecasting-models-arima.html#pm10-h-24"><i class="fa fa-check"></i><b>8.2.6</b> PM10 h = 24</a></li>
</ul></li>
</ul></li>
<li><a href="python-scripts.html#python-scripts"><em>Python scripts</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Gijón Air Pollution - An exercise of visualization and forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gathering-and-cleaning-data" class="section level1">
<h1><span class="header-section-number">6</span> Gathering and Cleaning Data</h1>
<div id="data-gathering" class="section level2">
<h2><span class="header-section-number">6.1</span> Data gathering</h2>
<p>Loading packages</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(purrr)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(xts)
<span class="kw">library</span>(zoo)
<span class="kw">library</span>(gridExtra)
<span class="kw">library</span>(fpp2)
<span class="kw">library</span>(RcppRoll)
<span class="kw">library</span>(kableExtra)

<span class="kw">options</span>(<span class="dt">knitr.table.format =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<p>First of all I have to check if I will have the basic data to make the analysis. I need air pollution and weather data of the Gijon area. The town hall of Gijon has an open data web portal here <a href="https://transparencia.gijon.es/" class="uri">https://transparencia.gijon.es/</a>. We can download pollution air data on csv format from year 2000 to 2017 <a href="https://transparencia.gijon.es/search/risp_dataset/page/1808-catalogo-de-datos?utf8=%E2%9C%93&amp;search=aire+&amp;search_sector=&amp;search_format=&amp;commit=Buscar&amp;authenticity_token=j8%2F3CvCuPcDkrRe%2F1NR5RBp0t%2FOOosiA7724w3T2mB4%3D">here</a>:</p>
<p>I downloaded 18 csv files with air pollution and weather data of Gijon from years 2000 to 2017. I saved them in the “data” folder. I downloaded two more files from this web, a csv file with the description of the variables and another csv file with information about the measurement stations.</p>
<p>We take a look to the information included in the stations_info.csv file. It includes the stations addresses, longitude, latitude and their IDs and names. All this information, as we will see, is included in the csv files with pollution and weather data too. So, we are not going to use this file anymore.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stations &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&#39;data/stations_info.csv&#39;</span>,
                       <span class="dt">delim =</span> <span class="st">&#39;;&#39;</span>,
                       <span class="dt">escape_double =</span> <span class="ot">FALSE</span>,
                       <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>,
                       <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;ISO-8859-1&quot;</span>),
                       <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">.default =</span> <span class="st">&quot;c&quot;</span>))
stations</code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   `&quot;ID;&quot;&quot;Título&quot;&quot;` `&quot;&quot;Dirección&quot;&quot;` `&quot;&quot;Población&quot;&quot;` `&quot;&quot;Provincia&quot;&quot;`
##   &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          
## 1 &quot;\&quot;1;\&quot;\&quot;Consti~ &quot;\&quot;\&quot;Avda. Con~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## 2 &quot;\&quot;2;\&quot;\&quot;Argent~ &quot;\&quot;\&quot;Avda. Arg~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## 3 &quot;\&quot;3;\&quot;\&quot;H. Fel~ &quot;\&quot;\&quot;H. Felgue~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## 4 &quot;\&quot;4;\&quot;\&quot;Castil~ &quot;\&quot;\&quot;Plaza Cas~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## 5 &quot;\&quot;10;\&quot;\&quot;Monte~ &quot;\&quot;\&quot;Montevil\~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## 6 &quot;\&quot;11;\&quot;\&quot;Santa~ &quot;\&quot;\&quot;Santa Bár~ &quot;\&quot;\&quot;Gijón\&quot;\&quot;&quot; &quot;\&quot;\&quot;Asturias\~
## # ... with 2 more variables: `&quot;&quot;latitud&quot;&quot;` &lt;chr&gt;, `&quot;&quot;longitud&quot;&quot;&quot;,,` &lt;chr&gt;</code></pre>
<p>We can see on this image the location of each station. <a href="http://movil.asturias.es/medioambiente/articulos/ficheros/Informe%20de%20calidad%20del%20aire%20en%20Asturias%202016.pdf">http://movil.asturias.es/medioambiente/articulos/ficheros/Informe%20de%20calidad%20del%20aire%20en%20Asturias%202016.pdf</a></p>
<div class="figure">
<img src="imgs/gijon_stations_map.jpg" alt="Image source: Informe de calidad del aire del Principado de Asturias (2016)." />
<p class="caption">Image source: “Informe de calidad del aire del Principado de Asturias (2016)”.</p>
</div>
<p>The air_data_descriptors.csv file contains information about the nature of the elements monitored by the stations. Names, descriptions and units.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">variables &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;data/air_data_descriptors.csv&#39;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;ISO-8859-1&quot;</span>))
variables</code></pre></div>
<pre><code>## # A tibble: 17 x 4
##    Parametro `Descripción Parámetro`            TAG   Unidad
##    &lt;chr&gt;     &lt;chr&gt;                              &lt;chr&gt; &lt;chr&gt; 
##  1 BEN       Benceno                            BEN   µg/m³ 
##  2 CO        Concentracion de CO                CO    mg/m³ 
##  3 DD        Direccion del viento               DD    Grados
##  4 HR        Humedad relativa                   HR    %hr   
##  5 LL        Precipitacion                      LL    l/m²  
##  6 MXIL      MXileno                            MXIL  µg/m³ 
##  7 NO        Concentracion de NO                NO    µg/m³ 
##  8 NO2       Concentracion de NO2               NO2   µg/m³ 
##  9 O3        Concentracion de Ozono             O3    µg/m³ 
## 10 PM10      Particulas en suspension &lt;10 µg/m³ PM10  µg/m³ 
## 11 PM25      Particulas en Suspension PM 2,5    PM25  µg/m³ 
## 12 PRB       Presion Atmosferica                PRB   mb    
## 13 RS        Radiacion Solar                    RS    W/m²  
## 14 SO2       Concentracion de SO2               SO2   µg/m³ 
## 15 TMP       Temperatura Seca                   TMP   ºC    
## 16 TOL       Tolueno                            TOL   µg/m³ 
## 17 VV        Velocidad del viento               VV    m/s</code></pre>
<p>In order to import the data from the 18 csv files we list all the files in the object data_files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;air_data_20*&quot;</span>)</code></pre></div>
<p>Then, we map the function read_csv on this list in order to import every file and finally merge them in a unique dataframe (air_data_0) with reduce(rbind).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">0</span> &lt;-<span class="st"> </span>data_files <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">map</span>(<span class="cf">function</span>(x) {
        <span class="kw">read_csv</span>(<span class="kw">paste0</span>(<span class="st">&quot;./data/&quot;</span>, x), <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;ISO-8859-1&quot;</span>), <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">.default =</span> <span class="st">&quot;c&quot;</span>))
    }) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">reduce</span>(rbind)</code></pre></div>
<p>We take a look to the dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(air_data_<span class="dv">0</span>)</code></pre></div>
<pre><code>## Observations: 722,774
## Variables: 22
## $ Estación            &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1...
## $ Título              &lt;chr&gt; &quot;Estación Avenida Constitución&quot;, &quot;Estación...
## $ latitud             &lt;chr&gt; &quot;43.529806&quot;, &quot;43.529806&quot;, &quot;43.529806&quot;, &quot;43...
## $ longitud            &lt;chr&gt; &quot;-5.673428&quot;, &quot;-5.673428&quot;, &quot;-5.673428&quot;, &quot;-5...
## $ `Fecha Solar (UTC)` &lt;chr&gt; &quot;2000-01-01T00:00:00&quot;, &quot;2000-01-01T01:00:0...
## $ SO2                 &lt;chr&gt; &quot;23&quot;, &quot;29&quot;, &quot;40&quot;, &quot;50&quot;, &quot;39&quot;, &quot;39&quot;, &quot;40&quot;, ...
## $ NO                  &lt;chr&gt; &quot;89&quot;, &quot;73&quot;, &quot;53&quot;, &quot;46&quot;, &quot;35&quot;, &quot;26&quot;, &quot;27&quot;, ...
## $ NO2                 &lt;chr&gt; &quot;65&quot;, &quot;60&quot;, &quot;57&quot;, &quot;53&quot;, &quot;50&quot;, &quot;49&quot;, &quot;51&quot;, ...
## $ CO                  &lt;chr&gt; &quot;1.97&quot;, &quot;1.61&quot;, &quot;1.13&quot;, &quot;1.06&quot;, &quot;0.95&quot;, &quot;0...
## $ PM10                &lt;chr&gt; &quot;53&quot;, &quot;63&quot;, &quot;56&quot;, &quot;58&quot;, &quot;50&quot;, &quot;50&quot;, &quot;57&quot;, ...
## $ O3                  &lt;chr&gt; &quot;9&quot;, &quot;8&quot;, &quot;7&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;7&quot;, &quot;4&quot;, &quot;5...
## $ dd                  &lt;chr&gt; &quot;245&quot;, &quot;222&quot;, &quot;228&quot;, &quot;239&quot;, &quot;244&quot;, &quot;218&quot;, ...
## $ vv                  &lt;chr&gt; &quot;0.34&quot;, &quot;1.06&quot;, &quot;0.71&quot;, &quot;0.84&quot;, &quot;0.89&quot;, &quot;0...
## $ TMP                 &lt;chr&gt; &quot;5.7&quot;, &quot;5.4&quot;, &quot;5.3&quot;, &quot;5.1&quot;, &quot;4.6&quot;, &quot;4.6&quot;, ...
## $ HR                  &lt;chr&gt; &quot;76&quot;, &quot;73&quot;, &quot;72&quot;, &quot;71&quot;, &quot;72&quot;, &quot;69&quot;, &quot;68&quot;, ...
## $ PRB                 &lt;chr&gt; &quot;1026&quot;, &quot;1025&quot;, &quot;1025&quot;, &quot;1025&quot;, &quot;1024&quot;, &quot;1...
## $ RS                  &lt;chr&gt; &quot;33&quot;, &quot;33&quot;, &quot;33&quot;, &quot;33&quot;, &quot;33&quot;, &quot;33&quot;, &quot;33&quot;, ...
## $ LL                  &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0...
## $ BEN                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ TOL                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ MXIL                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PM25                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</code></pre>
<p>We change some variables names.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Variables names changing</span>
air_data_<span class="dv">1</span> &lt;-<span class="st"> </span>air_data_<span class="dv">0</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">station =</span> <span class="st">&#39;Estación&#39;,</span>
<span class="st">                                    station_name = &#39;</span>Título<span class="st">&#39;,</span>
<span class="st">                                    date_time_utc = &#39;</span>Fecha <span class="kw">Solar</span> (UTC)<span class="st">&#39;,</span>
<span class="st">                                    latitude = latitud,</span>
<span class="st">                                    longitude = longitud,</span>
<span class="st">                                    wd = dd,</span>
<span class="st">                                    ws = vv)</span></code></pre></div>
</div>
<div id="data-cleaning" class="section level2">
<h2><span class="header-section-number">6.2</span> Data cleaning</h2>
<p>We imported all the columns as characters in order to avoid problems with the format attributions. So, we have to make now some format variable changes.</p>
<p>We change the date_time_utc format from character to date time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">1</span><span class="op">$</span>date_time_utc &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(air_data_<span class="dv">1</span><span class="op">$</span>date_time_utc)</code></pre></div>
<p>We change the station and station_name formats from character to factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">1</span><span class="op">$</span>station &lt;-<span class="st"> </span><span class="kw">as.factor</span>(air_data_<span class="dv">1</span><span class="op">$</span>station)
air_data_<span class="dv">1</span><span class="op">$</span>station_name &lt;-<span class="st"> </span><span class="kw">as.factor</span>(air_data_<span class="dv">1</span><span class="op">$</span>station_name)</code></pre></div>
<p>We create a vector with all the variables we want to be numeric</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &lt;-<span class="st"> </span><span class="kw">colnames</span>(air_data_<span class="dv">1</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">22</span>)]</code></pre></div>
<p>We make the conversion of this set of variables to numeric</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">1</span> &lt;-<span class="st"> </span>air_data_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_at</span>(num, as.numeric)</code></pre></div>
<p>We create a dictionary with an alias for each station in order to add a new variable with more convenient station names</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alias_dict &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
      <span class="dt">station =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>),
      <span class="dt">station_alias =</span> <span class="kw">c</span>(<span class="st">&quot;Constitucion&quot;</span>, <span class="st">&quot;Argentina&quot;</span>, <span class="st">&quot;H. Felgueroso&quot;</span>, <span class="st">&quot;Castilla&quot;</span>, <span class="st">&quot;Montevil&quot;</span>, <span class="st">&quot;Santa Barbara&quot;</span>)
)</code></pre></div>
<p>We join the alias dictionary to the air_data_1 data frame to add the new variable to the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">1</span> &lt;-<span class="st"> </span>air_data_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(alias_dict, <span class="dt">by =</span> <span class="st">&#39;station&#39;</span>)</code></pre></div>
<p>We call the summary function to inspect the data main indicators</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(air_data_<span class="dv">1</span>)</code></pre></div>
<pre><code>##  station                                   station_name       latitude    
##  1 :157727   Estación Avenida Argentina          :157798   Min.   :43.52  
##  10: 74630   Estación Avenida Castilla           :157409   1st Qu.:43.53  
##  11: 17544   Estación Avenida Constitución       :157727   Median :43.54  
##  2 :157798   Estación Avenida Hermanos Felgueroso:157666   Mean   :43.53  
##  3 :157666   Estación de Montevil                : 74630   3rd Qu.:43.54  
##  4 :157409   Estación Santa Bárbara              : 17544   Max.   :43.54  
##                                                                           
##    longitude      date_time_utc                      SO2          
##  Min.   :-5.699   Min.   :2000-01-01 00:00:00   Min.   :-9999.00  
##  1st Qu.:-5.673   1st Qu.:2005-02-25 05:00:00   1st Qu.:    4.00  
##  Median :-5.672   Median :2010-02-23 11:00:00   Median :    6.00  
##  Mean   :-5.670   Mean   :2009-09-06 07:33:13   Mean   :    9.77  
##  3rd Qu.:-5.658   3rd Qu.:2014-04-09 06:00:00   3rd Qu.:   11.00  
##  Max.   :-5.646   Max.   :2018-01-01 00:00:00   Max.   : 2662.00  
##                                                 NA&#39;s   :33742     
##        NO                NO2                 CO             PM10         
##  Min.   :-9999.00   Min.   :-9999.00   Min.   : 0.00   Min.   :-9999.00  
##  1st Qu.:    4.40   1st Qu.:   16.00   1st Qu.: 0.22   1st Qu.:   19.00  
##  Median :   10.00   Median :   28.00   Median : 0.36   Median :   30.00  
##  Mean   :   21.37   Mean   :   32.04   Mean   : 0.49   Mean   :   35.88  
##  3rd Qu.:   23.00   3rd Qu.:   45.00   3rd Qu.: 0.59   3rd Qu.:   46.00  
##  Max.   : 1248.00   Max.   : 1003.20   Max.   :58.20   Max.   : 1000.00  
##  NA&#39;s   :16989      NA&#39;s   :16446      NA&#39;s   :90390   NA&#39;s   :88598     
##        O3                 wd               ws              TMP        
##  Min.   :-9999.00   Min.   :  0.0    Min.   : 0.0     Min.   :-40.0   
##  1st Qu.:   17.00   1st Qu.: 96.0    1st Qu.: 0.2     1st Qu.: 10.9   
##  Median :   37.00   Median :159.0    Median : 0.7     Median : 14.7   
##  Mean   :   38.97   Mean   :161.8    Mean   : 1.0     Mean   : 14.6   
##  3rd Qu.:   57.00   3rd Qu.:228.0    3rd Qu.: 1.5     3rd Qu.: 18.4   
##  Max.   :  998.00   Max.   :360.0    Max.   :29.8     Max.   : 47.4   
##  NA&#39;s   :31417      NA&#39;s   :494134   NA&#39;s   :493893   NA&#39;s   :494151  
##        HR              PRB               RS               LL        
##  Min.   :  0.0    Min.   : 800     Min.   :  -1.0   Min.   : 0.0    
##  1st Qu.: 69.0    1st Qu.:1007     1st Qu.:  17.0   1st Qu.: 0.0    
##  Median : 80.0    Median :1013     Median :  46.0   Median : 0.0    
##  Mean   : 78.3    Mean   :1012     Mean   : 125.2   Mean   : 0.1    
##  3rd Qu.: 89.0    3rd Qu.:1018     3rd Qu.: 149.0   3rd Qu.: 0.0    
##  Max.   :123.0    Max.   :1282     Max.   :1470.0   Max.   :24.6    
##  NA&#39;s   :494176   NA&#39;s   :494019   NA&#39;s   :494273   NA&#39;s   :494124  
##       BEN              TOL              MXIL             PM25       
##  Min.   : 0.0     Min.   : -0.2    Min.   : -0.3    Min.   :  0.0   
##  1st Qu.: 0.1     1st Qu.:  0.4    1st Qu.:  0.2    1st Qu.:  5.0   
##  Median : 0.3     Median :  1.0    Median :  0.3    Median :  9.0   
##  Mean   : 0.5     Mean   :  2.5    Mean   :  1.3    Mean   : 11.3   
##  3rd Qu.: 0.5     3rd Qu.:  2.5    3rd Qu.:  0.9    3rd Qu.: 15.0   
##  Max.   :22.5     Max.   :196.0    Max.   :220.0    Max.   :947.0   
##  NA&#39;s   :629358   NA&#39;s   :629380   NA&#39;s   :635123   NA&#39;s   :554185  
##        station_alias   
##  Argentina    :157798  
##  Castilla     :157409  
##  Constitucion :157727  
##  H. Felgueroso:157666  
##  Montevil     : 74630  
##  Santa Barbara: 17544  
## </code></pre>
<p>There are several variables which minimun values are -9999.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(air_data_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(SO2 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span> <span class="op">|</span>
<span class="st">                              </span>NO <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span> <span class="op">|</span>
<span class="st">                              </span>NO2 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span> <span class="op">|</span>
<span class="st">                              </span>PM10 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span> <span class="op">|</span>
<span class="st">                              </span>O3 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span> )) <span class="op">%&gt;%</span>
<span class="st">                              </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station
</th>
<th style="text-align:left;">
station_name
</th>
<th style="text-align:right;">
latitude
</th>
<th style="text-align:right;">
longitude
</th>
<th style="text-align:left;">
date_time_utc
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
<th style="text-align:left;">
station_alias
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 00:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 01:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 02:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 03:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 04:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 05:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 06:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 07:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 08:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 09:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 10:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 11:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 12:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 13:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 14:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 15:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 16:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 17:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 18:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 19:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 20:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 21:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 22:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Estación Avenida Hermanos Felgueroso
</td>
<td style="text-align:right;">
43.53506
</td>
<td style="text-align:right;">
-5.658123
</td>
<td style="text-align:left;">
2000-01-27 23:00:00
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
H. Felgueroso
</td>
</tr>
</tbody>
</table>
<p>They are all from the same day (2000-01-27) and from the same station (‘H. Felgueroso’). We replace these values by NAs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">SO2 =</span> <span class="kw">replace</span>(SO2, SO2 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span>, <span class="ot">NA</span>),
                                    <span class="dt">NO =</span> <span class="kw">replace</span>(NO, NO <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span>, <span class="ot">NA</span>),
                                    <span class="dt">NO2 =</span> <span class="kw">replace</span>(NO2, NO2 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span>, <span class="ot">NA</span>),
                                    <span class="dt">PM10 =</span> <span class="kw">replace</span>(PM10, PM10 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span>, <span class="ot">NA</span>),
                                    <span class="dt">O3 =</span> <span class="kw">replace</span>(O3, O3 <span class="op">==</span><span class="st"> </span><span class="op">-</span><span class="dv">9999</span>, <span class="ot">NA</span>))</code></pre></div>
<p>We check again the output of the summary function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(air_data_<span class="dv">2</span>)</code></pre></div>
<pre><code>##  station                                   station_name       latitude    
##  1 :157727   Estación Avenida Argentina          :157798   Min.   :43.52  
##  10: 74630   Estación Avenida Castilla           :157409   1st Qu.:43.53  
##  11: 17544   Estación Avenida Constitución       :157727   Median :43.54  
##  2 :157798   Estación Avenida Hermanos Felgueroso:157666   Mean   :43.53  
##  3 :157666   Estación de Montevil                : 74630   3rd Qu.:43.54  
##  4 :157409   Estación Santa Bárbara              : 17544   Max.   :43.54  
##                                                                           
##    longitude      date_time_utc                      SO2         
##  Min.   :-5.699   Min.   :2000-01-01 00:00:00   Min.   :  -2.00  
##  1st Qu.:-5.673   1st Qu.:2005-02-25 05:00:00   1st Qu.:   4.00  
##  Median :-5.672   Median :2010-02-23 11:00:00   Median :   6.00  
##  Mean   :-5.670   Mean   :2009-09-06 07:33:13   Mean   :  10.12  
##  3rd Qu.:-5.658   3rd Qu.:2014-04-09 06:00:00   3rd Qu.:  11.00  
##  Max.   :-5.646   Max.   :2018-01-01 00:00:00   Max.   :2662.00  
##                                                 NA&#39;s   :33766    
##        NO               NO2                CO             PM10        
##  Min.   :   0.00   Min.   :   0.00   Min.   : 0.00   Min.   :   0.00  
##  1st Qu.:   4.40   1st Qu.:  16.00   1st Qu.: 0.22   1st Qu.:  19.00  
##  Median :  10.00   Median :  28.00   Median : 0.36   Median :  30.00  
##  Mean   :  21.71   Mean   :  32.38   Mean   : 0.49   Mean   :  36.26  
##  3rd Qu.:  23.00   3rd Qu.:  45.00   3rd Qu.: 0.59   3rd Qu.:  46.00  
##  Max.   :1248.00   Max.   :1003.20   Max.   :58.20   Max.   :1000.00  
##  NA&#39;s   :17013     NA&#39;s   :16470     NA&#39;s   :90390   NA&#39;s   :88622    
##        O3               wd               ws              TMP        
##  Min.   :  0.00   Min.   :  0.0    Min.   : 0.0     Min.   :-40.0   
##  1st Qu.: 17.00   1st Qu.: 96.0    1st Qu.: 0.2     1st Qu.: 10.9   
##  Median : 37.00   Median :159.0    Median : 0.7     Median : 14.7   
##  Mean   : 39.32   Mean   :161.8    Mean   : 1.0     Mean   : 14.6   
##  3rd Qu.: 57.00   3rd Qu.:228.0    3rd Qu.: 1.5     3rd Qu.: 18.4   
##  Max.   :998.00   Max.   :360.0    Max.   :29.8     Max.   : 47.4   
##  NA&#39;s   :31441    NA&#39;s   :494134   NA&#39;s   :493893   NA&#39;s   :494151  
##        HR              PRB               RS               LL        
##  Min.   :  0.0    Min.   : 800     Min.   :  -1.0   Min.   : 0.0    
##  1st Qu.: 69.0    1st Qu.:1007     1st Qu.:  17.0   1st Qu.: 0.0    
##  Median : 80.0    Median :1013     Median :  46.0   Median : 0.0    
##  Mean   : 78.3    Mean   :1012     Mean   : 125.2   Mean   : 0.1    
##  3rd Qu.: 89.0    3rd Qu.:1018     3rd Qu.: 149.0   3rd Qu.: 0.0    
##  Max.   :123.0    Max.   :1282     Max.   :1470.0   Max.   :24.6    
##  NA&#39;s   :494176   NA&#39;s   :494019   NA&#39;s   :494273   NA&#39;s   :494124  
##       BEN              TOL              MXIL             PM25       
##  Min.   : 0.0     Min.   : -0.2    Min.   : -0.3    Min.   :  0.0   
##  1st Qu.: 0.1     1st Qu.:  0.4    1st Qu.:  0.2    1st Qu.:  5.0   
##  Median : 0.3     Median :  1.0    Median :  0.3    Median :  9.0   
##  Mean   : 0.5     Mean   :  2.5    Mean   :  1.3    Mean   : 11.3   
##  3rd Qu.: 0.5     3rd Qu.:  2.5    3rd Qu.:  0.9    3rd Qu.: 15.0   
##  Max.   :22.5     Max.   :196.0    Max.   :220.0    Max.   :947.0   
##  NA&#39;s   :629358   NA&#39;s   :629380   NA&#39;s   :635123   NA&#39;s   :554185  
##        station_alias   
##  Argentina    :157798  
##  Castilla     :157409  
##  Constitucion :157727  
##  H. Felgueroso:157666  
##  Montevil     : 74630  
##  Santa Barbara: 17544  
## </code></pre>
<p>Some pollutant variables have as minimum negative values. It does not make much sense. We take a look to the data in order to quantify the problem.</p>
<p>30 SO2 observations between 2015-12-25 and 2015-12-28 from the Montevil station:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(neg_SO2 &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(SO2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1    30</code></pre>
<p>2 RS observations from the Constitucion station:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(neg_RS &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(RS <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1     2</code></pre>
<p>27 TOL observations between the 2008-12-11 and the 2008-12-15 from the Constitucion station:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(neg_TOL &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(TOL <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1    27</code></pre>
<p>59 MXIL observations between the 2008-12-10 and the 2008-12-15 from the Constitucion station:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(neg_MXIL &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(MXIL <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1    59</code></pre>
<p>There are not many cases. We replace them all by NAs and call again the summary function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">SO2 =</span> <span class="kw">replace</span>(SO2, SO2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>),
                                    <span class="dt">RS =</span> <span class="kw">replace</span>(RS, RS <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>),
                                    <span class="dt">TOL =</span> <span class="kw">replace</span>(TOL, TOL <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>),
                                    <span class="dt">MXIL =</span> <span class="kw">replace</span>(MXIL, MXIL <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>))

<span class="kw">summary</span>(air_data_<span class="dv">2</span>)</code></pre></div>
<pre><code>##  station                                   station_name       latitude    
##  1 :157727   Estación Avenida Argentina          :157798   Min.   :43.52  
##  10: 74630   Estación Avenida Castilla           :157409   1st Qu.:43.53  
##  11: 17544   Estación Avenida Constitución       :157727   Median :43.54  
##  2 :157798   Estación Avenida Hermanos Felgueroso:157666   Mean   :43.53  
##  3 :157666   Estación de Montevil                : 74630   3rd Qu.:43.54  
##  4 :157409   Estación Santa Bárbara              : 17544   Max.   :43.54  
##                                                                           
##    longitude      date_time_utc                      SO2         
##  Min.   :-5.699   Min.   :2000-01-01 00:00:00   Min.   :   0.00  
##  1st Qu.:-5.673   1st Qu.:2005-02-25 05:00:00   1st Qu.:   4.00  
##  Median :-5.672   Median :2010-02-23 11:00:00   Median :   6.00  
##  Mean   :-5.670   Mean   :2009-09-06 07:33:13   Mean   :  10.12  
##  3rd Qu.:-5.658   3rd Qu.:2014-04-09 06:00:00   3rd Qu.:  11.00  
##  Max.   :-5.646   Max.   :2018-01-01 00:00:00   Max.   :2662.00  
##                                                 NA&#39;s   :33796    
##        NO               NO2                CO             PM10        
##  Min.   :   0.00   Min.   :   0.00   Min.   : 0.00   Min.   :   0.00  
##  1st Qu.:   4.40   1st Qu.:  16.00   1st Qu.: 0.22   1st Qu.:  19.00  
##  Median :  10.00   Median :  28.00   Median : 0.36   Median :  30.00  
##  Mean   :  21.71   Mean   :  32.38   Mean   : 0.49   Mean   :  36.26  
##  3rd Qu.:  23.00   3rd Qu.:  45.00   3rd Qu.: 0.59   3rd Qu.:  46.00  
##  Max.   :1248.00   Max.   :1003.20   Max.   :58.20   Max.   :1000.00  
##  NA&#39;s   :17013     NA&#39;s   :16470     NA&#39;s   :90390   NA&#39;s   :88622    
##        O3               wd               ws              TMP        
##  Min.   :  0.00   Min.   :  0.0    Min.   : 0.0     Min.   :-40.0   
##  1st Qu.: 17.00   1st Qu.: 96.0    1st Qu.: 0.2     1st Qu.: 10.9   
##  Median : 37.00   Median :159.0    Median : 0.7     Median : 14.7   
##  Mean   : 39.32   Mean   :161.8    Mean   : 1.0     Mean   : 14.6   
##  3rd Qu.: 57.00   3rd Qu.:228.0    3rd Qu.: 1.5     3rd Qu.: 18.4   
##  Max.   :998.00   Max.   :360.0    Max.   :29.8     Max.   : 47.4   
##  NA&#39;s   :31441    NA&#39;s   :494134   NA&#39;s   :493893   NA&#39;s   :494151  
##        HR              PRB               RS               LL        
##  Min.   :  0.0    Min.   : 800     Min.   :   0.0   Min.   : 0.0    
##  1st Qu.: 69.0    1st Qu.:1007     1st Qu.:  17.0   1st Qu.: 0.0    
##  Median : 80.0    Median :1013     Median :  46.0   Median : 0.0    
##  Mean   : 78.3    Mean   :1012     Mean   : 125.2   Mean   : 0.1    
##  3rd Qu.: 89.0    3rd Qu.:1018     3rd Qu.: 149.0   3rd Qu.: 0.0    
##  Max.   :123.0    Max.   :1282     Max.   :1470.0   Max.   :24.6    
##  NA&#39;s   :494176   NA&#39;s   :494019   NA&#39;s   :494275   NA&#39;s   :494124  
##       BEN              TOL              MXIL             PM25       
##  Min.   : 0.0     Min.   :  0.0    Min.   :  0.0    Min.   :  0.0   
##  1st Qu.: 0.1     1st Qu.:  0.4    1st Qu.:  0.2    1st Qu.:  5.0   
##  Median : 0.3     Median :  1.0    Median :  0.3    Median :  9.0   
##  Mean   : 0.5     Mean   :  2.5    Mean   :  1.3    Mean   : 11.3   
##  3rd Qu.: 0.5     3rd Qu.:  2.5    3rd Qu.:  0.9    3rd Qu.: 15.0   
##  Max.   :22.5     Max.   :196.0    Max.   :220.0    Max.   :947.0   
##  NA&#39;s   :629358   NA&#39;s   :629407   NA&#39;s   :635182   NA&#39;s   :554185  
##        station_alias   
##  Argentina    :157798  
##  Castilla     :157409  
##  Constitucion :157727  
##  H. Felgueroso:157666  
##  Montevil     : 74630  
##  Santa Barbara: 17544  
## </code></pre>
<p>We take a look to the data completeness. What proportion of nas do we have by variable, station, year, etc?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_completeness &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(station_alias, <span class="dt">year =</span> <span class="kw">year</span>(date_time_utc)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">round</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.))<span class="op">/</span><span class="kw">n</span>(), <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># We obtain the proportion of &#39;not NAs&#39;</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">28</span>)) <span class="co"># These columns do not have any na. We exclude them.</span>

<span class="kw">head</span>(data_completeness, <span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>We are going to check the data completeness by station:</p>
<p>Constitución: There is data registered from the variables SO2, NO, NO2, CO, PM10, 03, dd, vv, TMP, HR, PRB, HS and LL since the year 2000. There are measurements of the variables BEN, TOL and MXIL since the year 2006 (only 0.01% ). The PM25 particles are monitored since the year 2008 (2008: only covered 0,02% of the year). During the year 2008 the completeness of several variables (HR, PRB, HS, LL, BEN, TOL y MXIL) decrease until 88% (to do: check there was not caused by a data importing problem.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">constitucion_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Constitucion&#39;</span>)
constitucion_data <span class="op">%&gt;%</span>
<span class="st">                  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">                  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.95
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Constitucion
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
<p>Argentina: data since the year 2000. Variables: SO2, NO, NO2, CO, PM10 and 03.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">argentina_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Argentina&#39;</span>)
argentina_data <span class="op">%&gt;%</span>
<span class="st">            </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">            </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>H. Felgueroso: data since the year 2000. Variables: SO2, NO, NO2, CO, PM10 and 03. During the year 2006 the completeness of the data decrease until 88% (to do: check there was not caused by a data importing problem.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">felgueroso_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;H. Felgueroso&#39;</span>)

felgueroso_data <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
H. Felgueroso
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Castilla: data since the year 2000. Variables: SO2, NO, NO2, CO, PM10 and 03. During the year 2015 the completeness of the data decrease until 77% (to do: check there was not caused by a data importing problem.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">castilla_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Castilla&#39;</span>)
castilla_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Castilla
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Montevil: Data since the year 2009. Variables: SO2, NO, NO2, 03, dd, vv, TMP, HR, PRB, HS, LL and PM25.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">montevil_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Montevil&#39;</span>)
montevil_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.93
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.92
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;">
Montevil
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
<p>Santa Bárbara: Data since the year 2016. Variables: NO, NO2, CO, PM10, 03 and PM25</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">barbara_data &lt;-<span class="st"> </span>data_completeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station_alias <span class="op">==</span><span class="st"> &#39;Santa Barbara&#39;</span>)
barbara_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
station_alias
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
SO2
</th>
<th style="text-align:right;">
NO
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
PM10
</th>
<th style="text-align:right;">
O3
</th>
<th style="text-align:right;">
wd
</th>
<th style="text-align:right;">
ws
</th>
<th style="text-align:right;">
TMP
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
PRB
</th>
<th style="text-align:right;">
RS
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
BEN
</th>
<th style="text-align:right;">
TOL
</th>
<th style="text-align:right;">
MXIL
</th>
<th style="text-align:right;">
PM25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Santa Barbara
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;">
Santa Barbara
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Santa Barbara
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
<p>All the stations have 2018 data, but it is just 6 observations. We drop them to avoid problems when visualising the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">observations_per_year &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="dt">year =</span> <span class="kw">year</span>(date_time_utc)) <span class="op">%&gt;%</span>
<span class="st">                        </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())
observations_per_year <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
35136
</td>
</tr>
<tr>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;">
35040
</td>
</tr>
<tr>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
35040
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
35040
</td>
</tr>
<tr>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
35136
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
35040
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
34939
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
34921
</td>
</tr>
<tr>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
35136
</td>
</tr>
<tr>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
39541
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
43800
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
43800
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
43920
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
43800
</td>
</tr>
<tr>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
43800
</td>
</tr>
<tr>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
43416
</td>
</tr>
<tr>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
52703
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
52560
</td>
</tr>
<tr>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">2</span><span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">year</span>(air_data_<span class="dv">2</span><span class="op">$</span>date_time_utc)
air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> &#39;2018&#39;</span>)</code></pre></div>
</div>
<div id="adding-new-variables" class="section level2">
<h2><span class="header-section-number">6.3</span> Adding new variables</h2>
<div id="time-variables" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Time variables</h3>
<p>We add to the dataset several more time variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data_<span class="dv">2</span><span class="op">$</span>month &lt;-<span class="st"> </span><span class="kw">month</span>(air_data_<span class="dv">2</span><span class="op">$</span>date_time_utc)
air_data_<span class="dv">2</span><span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(air_data_<span class="dv">2</span><span class="op">$</span>date_time_utc)
air_data_<span class="dv">2</span><span class="op">$</span>week_day &lt;-<span class="st"> </span><span class="kw">wday</span>(air_data_<span class="dv">2</span><span class="op">$</span>date_time_utc, <span class="dt">week_start =</span> <span class="kw">getOption</span>(<span class="st">&quot;lubridate.week.start&quot;</span>, <span class="dv">1</span>))
air_data_<span class="dv">2</span><span class="op">$</span>hour &lt;-<span class="st"> </span><span class="kw">hour</span>(air_data_<span class="dv">2</span><span class="op">$</span>date_time_utc)</code></pre></div>
</div>
<div id="laboral-dates" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Laboral dates</h3>
<p>And we add a variable with the with the ‘non-working days’ of Gijon city from 2014 to 2017.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">holydays &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;data/holiday_dates.csv&#39;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;ISO-8859-1&quot;</span>))

air_data_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(air_data_<span class="dv">2</span>, holydays, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;date&quot;</span> =<span class="st"> &quot;holiday_date&quot;</span>))

air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">no_lab_days =</span> <span class="kw">ifelse</span>((week_day <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(holiday_type)) <span class="op">|</span>
<span class="st">                                                    </span>(week_day <span class="op">&gt;=</span><span class="dv">6</span>), <span class="st">&quot;no_lab&quot;</span>, <span class="st">&quot;lab&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">                                                     </span><span class="kw">mutate</span>(<span class="dt">no_lab_days=</span><span class="kw">replace</span>(no_lab_days, date <span class="op">&lt;</span><span class="st"> &#39;2014-01-01&#39;</span>, <span class="ot">NA</span>))</code></pre></div>
</div>
<div id="wind-direction" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Wind direction</h3>
<p>We create another variable to have a factor version of the ‘dd’ variable (wind direction in degrees). I took this snippet of code from here: <a href="https://community.rstudio.com/t/convert-wind-direction-degrees-into-factors-in-a-data-frame/14636/4" class="uri">https://community.rstudio.com/t/convert-wind-direction-degrees-into-factors-in-a-data-frame/14636/4</a></p>
<p>I made some changes because this code caused a problem when I tried to publish the document on bookdown</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rose_breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">360</span><span class="op">/</span><span class="dv">32</span>, (<span class="dv">1</span><span class="op">/</span><span class="dv">32</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span> <span class="op">/</span><span class="st"> </span><span class="dv">16</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">360</span>, <span class="dv">360</span>)

<span class="co"># The problem was the repetition of the level &quot;N&quot;. </span>
<span class="co"># So I splited this level in two, &quot;N1&quot; and &quot;N2&quot;.</span>
rose_labs &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">&quot;N1&quot;</span>, <span class="st">&quot;NNE&quot;</span>, <span class="st">&quot;NE&quot;</span>, <span class="st">&quot;ENE&quot;</span>,
  <span class="st">&quot;E&quot;</span>, <span class="st">&quot;ES&quot;</span>, <span class="st">&quot;SE&quot;</span>, <span class="st">&quot;SSE&quot;</span>,
  <span class="st">&quot;S&quot;</span>, <span class="st">&quot;SSW&quot;</span>, <span class="st">&quot;SW&quot;</span>, <span class="st">&quot;WS&quot;</span>,
  <span class="st">&quot;W&quot;</span>, <span class="st">&quot;WNW&quot;</span>, <span class="st">&quot;NW&quot;</span>, <span class="st">&quot;NNW&quot;</span>,
  <span class="st">&quot;N2&quot;</span>
)

air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">wd_code =</span> <span class="kw">cut</span>(
      wd,
      <span class="dt">breaks =</span> rose_breaks,
      <span class="dt">labels =</span> rose_labs,
      <span class="dt">right =</span> <span class="ot">FALSE</span>,
      <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>
    )
  )

<span class="co"># And I recoded to &quot;N&quot;</span>
air_data_<span class="dv">2</span> &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">wd_code =</span> <span class="kw">recode</span>(wd_code, <span class="dt">N1 =</span> <span class="st">&quot;N&quot;</span>,
                                                    <span class="dt">N2 =</span> <span class="st">&quot;N&quot;</span>))</code></pre></div>
<p>We save the final dataset as a rds object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(air_data_<span class="dv">2</span>, <span class="dt">file =</span> <span class="st">&quot;data_rds/air_data_2.rds&quot;</span>)</code></pre></div>
</div>
<div id="tables-preparation-for-tableau-dashboards" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Tables preparation for Tableau dashboards</h3>
<p>We are going to prepare some tables for the Tableau dashboards.</p>
<p>First of all we export the whole table to a csv file. I am not saving this file in the “data_final_csvs” folder because it exceeds the Github file limit size (100mb)(pendiente exportar a google drive)</p>
<p>I save the air_data_2.csv outside the project directory because it exceeds the 100mb github limit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># write_csv(air_data_2,&quot;C:/Users/SErgio/OneDrive/00_master_data_science/TFM/air_data_2.csv&quot;)</span></code></pre></div>
<div id="co-tables" class="section level4">
<h4><span class="header-section-number">6.3.4.1</span> CO tables</h4>
<p>We create a CO dataset with CO Moving averages (each 8 hours). It is needed to measure the accomplishment of UE limits for this pollutant</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">co_data &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(station_alias, date_time_utc, CO) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">mutate</span>(<span class="dt">ma_co_8 =</span> <span class="kw">roll_mean</span>(CO, <span class="dv">8</span>, <span class="dt">fill=</span><span class="dv">0</span>))

<span class="kw">hist</span>(co_data<span class="op">$</span>ma_co_<span class="dv">8</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(co_data<span class="op">$</span>ma_co_<span class="dv">8</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00    0.25    0.39    0.48    0.60   24.34  116415</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(co_data<span class="op">$</span>ma_co_<span class="dv">8</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pending na treatment</span>

<span class="kw">saveRDS</span>(co_data, <span class="dt">file =</span> <span class="st">&quot;data_rds/co_data.rds&quot;</span>)
<span class="kw">write_csv</span>(co_data, <span class="st">&quot;data_final_csvs/co_data.csv&quot;</span>)</code></pre></div>
</div>
<div id="o3-tables" class="section level4">
<h4><span class="header-section-number">6.3.4.2</span> O3 tables</h4>
<p>We create a O3 dataset with O3 Moving averages (each 8 hours). It is needed to measure the accomplishment of UE limits for this pollutant</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">o3_data &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(station_alias, date_time_utc, O3) <span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">mutate</span>(<span class="dt">ma_o3_8 =</span> <span class="kw">roll_mean</span>(O3, <span class="dv">8</span>, <span class="dt">fill=</span><span class="dv">0</span>),
                                 <span class="dt">o3_8_acc =</span> <span class="kw">ifelse</span>(ma_o3_<span class="dv">8</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">125</span>, <span class="st">&#39;no&#39;</span>, <span class="st">&#39;yes&#39;</span>))


<span class="kw">hist</span>(o3_data<span class="op">$</span>ma_o3_<span class="dv">8</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(o3_data<span class="op">$</span>ma_o3_<span class="dv">8</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.00   21.50   37.50   39.34   54.10  998.00   41435</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(o3_data<span class="op">$</span>ma_o3_<span class="dv">8</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pending na treatment</span>

<span class="kw">saveRDS</span>(o3_data, <span class="dt">file =</span> <span class="st">&quot;data_rds/o3_data.rds&quot;</span>)
<span class="kw">write_csv</span>(o3_data, <span class="st">&quot;data_final_csvs/o3_data.csv&quot;</span>)</code></pre></div>
</div>
<div id="so2-tables" class="section level4">
<h4><span class="header-section-number">6.3.4.3</span> SO2 tables</h4>
<p>RD 102/2011 Hourly limit: 350 ug/m3 (1 hour). &lt;= 24 times / year. Daily limit: 125 ug/m3 (24 hours). &lt;= 3 times / year. Alert threshold: 500 ug/m3 (3 hours).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">so2_data &lt;-<span class="st"> </span>air_data_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(station_alias, date_time_utc, SO2)

<span class="kw">saveRDS</span>(so2_data, <span class="dt">file =</span> <span class="st">&quot;data_rds/so2_data.rds&quot;</span>)
<span class="kw">write_csv</span>(so2_data, <span class="st">&quot;data_final_csvs/so2_data.csv&quot;</span>)

<span class="co"># How many times was the Hourly limit exceeded during the last 18 years?</span>

so2_hourly_limit &lt;-<span class="st"> </span>so2_data <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">group_by</span>(station_alias,
                             <span class="dt">year =</span> <span class="kw">year</span>(date_time_utc),
                             <span class="dt">day =</span> <span class="kw">date</span>(date_time_utc)) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">filter</span>(SO2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">350</span>) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">arrange</span>(year)


so2_hourly_limit</code></pre></div>
<pre><code>## # A tibble: 14 x 4
## # Groups:   station_alias, year [9]
##    station_alias  year day            n
##    &lt;fct&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;
##  1 Castilla       2001 2001-10-20     2
##  2 H. Felgueroso  2001 2001-10-20     2
##  3 Argentina      2004 2004-01-27     2
##  4 Argentina      2004 2004-01-28    12
##  5 Constitucion   2007 2007-05-30     1
##  6 Argentina      2008 2008-09-25     1
##  7 Argentina      2008 2008-11-27     1
##  8 Castilla       2008 2008-11-17     1
##  9 Castilla       2008 2008-12-25     4
## 10 Castilla       2008 2008-12-26     7
## 11 Castilla       2009 2009-01-05     1
## 12 Castilla       2011 2011-06-07     6
## 13 Castilla       2011 2011-06-08     1
## 14 Constitucion   2011 2011-01-13     3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(so2_hourly_limit, <span class="dt">file =</span> <span class="st">&quot;data_rds/so2_hourly_limit.rds&quot;</span>)
<span class="kw">write_csv</span>(so2_hourly_limit, <span class="st">&quot;data_final_csvs/so2_hourly_limit.csv&quot;</span>)


<span class="co"># How many times was the Daily limit exceeded during the last 18 years?</span>

so2_daily_limit &lt;-<span class="st"> </span>so2_data <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">group_by</span>(station_alias, <span class="dt">date =</span> <span class="kw">date</span>(date_time_utc), <span class="dt">year =</span> <span class="kw">year</span>(date_time_utc)) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">avg =</span> <span class="kw">mean</span>(SO2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">                    </span>ungroup <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">filter</span>(avg <span class="op">&gt;</span><span class="st"> </span><span class="dv">125</span>) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">group_by</span>(station_alias, year, date) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">arrange</span>(year)



so2_daily_limit</code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   station_alias, year [3]
##   station_alias  year date           n
##   &lt;fct&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;
## 1 Argentina      2004 2004-01-28     1
## 2 Castilla       2008 2008-11-17     1
## 3 Castilla       2008 2008-12-25     1
## 4 Castilla       2008 2008-12-26     1
## 5 Castilla       2011 2011-06-07     1
## 6 Castilla       2011 2011-06-08     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(so2_daily_limit, <span class="dt">file =</span> <span class="st">&quot;data_rds/so2_daily_limit.rds&quot;</span>)
<span class="kw">write_csv</span>(so2_daily_limit, <span class="st">&quot;data_final_csvs/so2_daily_limit.csv&quot;</span>)</code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-scripts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-exploration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
